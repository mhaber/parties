{
    "contents" : "rm(list = ls())\n\nlibrary(Zelig)\nlibrary(MCMCpack)\nlibrary(ggplot2)\nlibrary(ggthemes)\n\ndata(PErisk)\n\n# Run the MCMC Model\n\npost.samp <- MCMCmixfactanal(~courts+barb2+prsexp2+\n                             prscorr2+gdpw2,\n                             factors = 1, data=PErisk,\n                             lambda.constraints = list(courts=list(2,\"-\")),\n                             burnin=10000, mcmc=1000000, thin=100,\n                             verbose=TRUE, L0=0.25,\n                             store.lambda=TRUE, store.scores=TRUE, tune=.25)\n### Summary Diagnostics\n\n#plot(post.samp)\nsummary(post.samp)\n\n### Extract the loadings (Lambda)\nloadings <- summary(post.samp)$statistics[1:5]\n\n### Extract the 95% Credible Interval estimates of each loading\nci.loadings <- summary(post.samp)$quantiles[1:5,c(1,5)]\n\n### Extract the country scores (thetas) and confidence intervals \nthetas <- data.frame(PErisk$country,\n                     summary(post.samp)$statistics[6:67],\n                     summary(post.samp)$quantiles[6:67,c(1,5)])\nnames(thetas)[1] <- \"Country\"\nnames(thetas)[2] <- \"mean\"\nnames(thetas)[3] <- \"lower\"\nnames(thetas)[4] <- \"upper\"\nrownames(thetas) <- NULL\n\n\n### Plot\nthetas$Country <- factor(thetas$Country, \n                                levels = thetas[order(thetas$mean), \"Country\"]\n)\n\nggplot(thetas, aes(x=Country, y=mean, group=1)) +\n  geom_errorbar(width=.1, aes(ymin=lower, ymax=upper)) +\n  geom_point(shape=21, size=3, fill=\"white\") + \n  scale_y_continuous(breaks = c(0,25,50,75,100)) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + \n  geom_hline(yintercept = mean(thetas$mean), linetype = \"dashed\") +\n  coord_flip() + theme_tufte() + xlab(\"\") + ylab(\"\") +\n  ggtitle(\"Bayesian Factor Analysis\")\n",
    "created" : 1439985689299.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2920093636",
    "id" : "2FE4B579",
    "lastKnownWriteTime" : 1439373429,
    "path" : "~/github/gr16/r/test_model_MCMCmixfactanal.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}